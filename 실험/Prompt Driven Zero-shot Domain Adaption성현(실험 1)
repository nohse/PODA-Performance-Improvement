{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"op2r7XaW8_Ue","outputId":"c8cd13fd-b247-4542-da57-7f737503b102","executionInfo":{"status":"ok","timestamp":1720611393528,"user_tz":-540,"elapsed":19062,"user":{"displayName":"yechan kim","userId":"05640365410708377891"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive', force_remount=True)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"E66WQBgi9Htw","outputId":"5b08ebe7-7d3a-4511-8e26-6b63e37362fc","executionInfo":{"status":"ok","timestamp":1720611400786,"user_tz":-540,"elapsed":333,"user":{"displayName":"yechan kim","userId":"05640365410708377891"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["/content/drive/MyDrive/성현/PODA\n"]}],"source":["%cd /content/drive/MyDrive/성현/PODA"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"4W3Kyk729avm","executionInfo":{"status":"ok","timestamp":1720612014094,"user_tz":-540,"elapsed":87929,"user":{"displayName":"yechan kim","userId":"05640365410708377891"}},"outputId":"d9efb4f4-d49e-4e0c-8fc5-1a8c9f2f34ad"},"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting pickle5\n","  Downloading pickle5-0.0.11.tar.gz (132 kB)\n","\u001b[?25l     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m0.0/132.1 kB\u001b[0m \u001b[31m?\u001b[0m eta \u001b[36m-:--:--\u001b[0m\r\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m132.1/132.1 kB\u001b[0m \u001b[31m3.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Building wheels for collected packages: pickle5\n","  Building wheel for pickle5 (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for pickle5: filename=pickle5-0.0.11-cp310-cp310-linux_x86_64.whl size=255318 sha256=492fc9d0607cfee4cb2265f7b17bd6ffb8ca6fcf2704fa7acefa63a1fb006843\n","  Stored in directory: /root/.cache/pip/wheels/7d/14/ef/4aab19d27fa8e58772be5c71c16add0426acf9e1f64353235c\n","Successfully built pickle5\n","Installing collected packages: pickle5\n","Successfully installed pickle5-0.0.11\n","Requirement already satisfied: tqdm in /usr/local/lib/python3.10/dist-packages (4.66.4)\n","Collecting ftfy\n","  Downloading ftfy-6.2.0-py3-none-any.whl (54 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m54.4/54.4 kB\u001b[0m \u001b[31m2.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: wcwidth<0.3.0,>=0.2.12 in /usr/local/lib/python3.10/dist-packages (from ftfy) (0.2.13)\n","Installing collected packages: ftfy\n","Successfully installed ftfy-6.2.0\n","Requirement already satisfied: regex in /usr/local/lib/python3.10/dist-packages (2024.5.15)\n","Collecting git+https://github.com/openai/CLIP.git\n","  Cloning https://github.com/openai/CLIP.git to /tmp/pip-req-build-3tvi53y3\n","  Running command git clone --filter=blob:none --quiet https://github.com/openai/CLIP.git /tmp/pip-req-build-3tvi53y3\n","  Resolved https://github.com/openai/CLIP.git to commit dcba3cb2e2827b402d2701e7e1c7d9fed8a20ef1\n","  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Requirement already satisfied: ftfy in /usr/local/lib/python3.10/dist-packages (from clip==1.0) (6.2.0)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from clip==1.0) (24.1)\n","Requirement already satisfied: regex in /usr/local/lib/python3.10/dist-packages (from clip==1.0) (2024.5.15)\n","Requirement already satisfied: tqdm in /usr/local/lib/python3.10/dist-packages (from clip==1.0) (4.66.4)\n","Requirement already satisfied: torch in /usr/local/lib/python3.10/dist-packages (from clip==1.0) (2.3.0+cu121)\n","Requirement already satisfied: torchvision in /usr/local/lib/python3.10/dist-packages (from clip==1.0) (0.18.0+cu121)\n","Requirement already satisfied: wcwidth<0.3.0,>=0.2.12 in /usr/local/lib/python3.10/dist-packages (from ftfy->clip==1.0) (0.2.13)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from torch->clip==1.0) (3.15.4)\n","Requirement already satisfied: typing-extensions>=4.8.0 in /usr/local/lib/python3.10/dist-packages (from torch->clip==1.0) (4.12.2)\n","Requirement already satisfied: sympy in /usr/local/lib/python3.10/dist-packages (from torch->clip==1.0) (1.12.1)\n","Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch->clip==1.0) (3.3)\n","Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch->clip==1.0) (3.1.4)\n","Requirement already satisfied: fsspec in /usr/local/lib/python3.10/dist-packages (from torch->clip==1.0) (2023.6.0)\n","Collecting nvidia-cuda-nvrtc-cu12==12.1.105 (from torch->clip==1.0)\n","  Using cached nvidia_cuda_nvrtc_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (23.7 MB)\n","Collecting nvidia-cuda-runtime-cu12==12.1.105 (from torch->clip==1.0)\n","  Using cached nvidia_cuda_runtime_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (823 kB)\n","Collecting nvidia-cuda-cupti-cu12==12.1.105 (from torch->clip==1.0)\n","  Using cached nvidia_cuda_cupti_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (14.1 MB)\n","Collecting nvidia-cudnn-cu12==8.9.2.26 (from torch->clip==1.0)\n","  Using cached nvidia_cudnn_cu12-8.9.2.26-py3-none-manylinux1_x86_64.whl (731.7 MB)\n","Collecting nvidia-cublas-cu12==12.1.3.1 (from torch->clip==1.0)\n","  Using cached nvidia_cublas_cu12-12.1.3.1-py3-none-manylinux1_x86_64.whl (410.6 MB)\n","Collecting nvidia-cufft-cu12==11.0.2.54 (from torch->clip==1.0)\n","  Using cached nvidia_cufft_cu12-11.0.2.54-py3-none-manylinux1_x86_64.whl (121.6 MB)\n","Collecting nvidia-curand-cu12==10.3.2.106 (from torch->clip==1.0)\n","  Using cached nvidia_curand_cu12-10.3.2.106-py3-none-manylinux1_x86_64.whl (56.5 MB)\n","Collecting nvidia-cusolver-cu12==11.4.5.107 (from torch->clip==1.0)\n","  Using cached nvidia_cusolver_cu12-11.4.5.107-py3-none-manylinux1_x86_64.whl (124.2 MB)\n","Collecting nvidia-cusparse-cu12==12.1.0.106 (from torch->clip==1.0)\n","  Using cached nvidia_cusparse_cu12-12.1.0.106-py3-none-manylinux1_x86_64.whl (196.0 MB)\n","Collecting nvidia-nccl-cu12==2.20.5 (from torch->clip==1.0)\n","  Using cached nvidia_nccl_cu12-2.20.5-py3-none-manylinux2014_x86_64.whl (176.2 MB)\n","Collecting nvidia-nvtx-cu12==12.1.105 (from torch->clip==1.0)\n","  Using cached nvidia_nvtx_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (99 kB)\n","Requirement already satisfied: triton==2.3.0 in /usr/local/lib/python3.10/dist-packages (from torch->clip==1.0) (2.3.0)\n","Collecting nvidia-nvjitlink-cu12 (from nvidia-cusolver-cu12==11.4.5.107->torch->clip==1.0)\n","  Downloading nvidia_nvjitlink_cu12-12.5.82-py3-none-manylinux2014_x86_64.whl (21.3 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m21.3/21.3 MB\u001b[0m \u001b[31m6.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from torchvision->clip==1.0) (1.25.2)\n","Requirement already satisfied: pillow!=8.3.*,>=5.3.0 in /usr/local/lib/python3.10/dist-packages (from torchvision->clip==1.0) (9.4.0)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch->clip==1.0) (2.1.5)\n","Requirement already satisfied: mpmath<1.4.0,>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from sympy->torch->clip==1.0) (1.3.0)\n","Building wheels for collected packages: clip\n","  Building wheel for clip (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for clip: filename=clip-1.0-py3-none-any.whl size=1369490 sha256=be9ae7dcba6732e35108b616eea309af81e87a26fc2b9cbba83d437387ad921c\n","  Stored in directory: /tmp/pip-ephem-wheel-cache-3wdy1kof/wheels/da/2b/4c/d6691fa9597aac8bb85d2ac13b112deb897d5b50f5ad9a37e4\n","Successfully built clip\n","Installing collected packages: nvidia-nvtx-cu12, nvidia-nvjitlink-cu12, nvidia-nccl-cu12, nvidia-curand-cu12, nvidia-cufft-cu12, nvidia-cuda-runtime-cu12, nvidia-cuda-nvrtc-cu12, nvidia-cuda-cupti-cu12, nvidia-cublas-cu12, nvidia-cusparse-cu12, nvidia-cudnn-cu12, nvidia-cusolver-cu12, clip\n","Successfully installed clip-1.0 nvidia-cublas-cu12-12.1.3.1 nvidia-cuda-cupti-cu12-12.1.105 nvidia-cuda-nvrtc-cu12-12.1.105 nvidia-cuda-runtime-cu12-12.1.105 nvidia-cudnn-cu12-8.9.2.26 nvidia-cufft-cu12-11.0.2.54 nvidia-curand-cu12-10.3.2.106 nvidia-cusolver-cu12-11.4.5.107 nvidia-cusparse-cu12-12.1.0.106 nvidia-nccl-cu12-2.20.5 nvidia-nvjitlink-cu12-12.5.82 nvidia-nvtx-cu12-12.1.105\n"]}],"source":["! pip install pickle5\n","! pip install tqdm\n","! pip install ftfy\n","! pip install regex\n","! pip install git+https://github.com/openai/CLIP.git"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":8180645,"status":"ok","timestamp":1719850413780,"user":{"displayName":"yechan kim","userId":"05640365410708377891"},"user_tz":-540},"id":"Ln1UwvQM-Py9","outputId":"da3c5282-43fa-4b8d-979c-37dcc2c340cb"},"outputs":[{"name":"stdout","output_type":"stream","text":["2024-07-01 13:57:16.831374: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.\n","2024-07-01 13:57:16.883454: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n","2024-07-01 13:57:16.883503: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n","2024-07-01 13:57:16.884944: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n","2024-07-01 13:57:16.892481: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\n","To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n","2024-07-01 13:57:18.018644: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\n","synthaddtext\n","cuda\n","Dataset: cityscapes, Train set: 2975, Val set: 500\n","/usr/local/lib/python3.10/dist-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at ../aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)\n","  return F.conv2d(input, weight, bias, self.stride,\n","0\n","100\n","1\n","100\n","2\n","100\n","3\n","100\n","4\n","100\n","5\n","100\n","6\n","100\n","7\n","100\n","8\n","100\n","9\n","100\n","10\n","100\n","11\n","100\n","12\n","100\n","13\n","100\n","14\n","100\n","15\n","100\n","16\n","100\n","17\n","100\n","18\n","100\n","19\n","100\n","20\n","100\n","21\n","100\n","22\n","100\n","23\n","100\n","24\n","100\n","25\n","100\n","26\n","100\n","27\n","100\n","28\n","100\n","29\n","100\n","30\n","100\n","31\n","100\n","32\n","100\n","33\n","100\n","34\n","100\n","35\n","100\n","36\n","100\n","37\n","100\n","38\n","100\n","39\n","100\n","40\n","100\n","41\n","100\n","42\n","100\n","43\n","100\n","44\n","100\n","45\n","100\n","46\n","100\n","47\n","100\n","48\n","100\n","49\n","100\n","50\n","100\n","51\n","100\n","52\n","100\n","53\n","100\n","54\n","100\n","55\n","100\n","56\n","100\n","57\n","100\n","58\n","100\n","59\n","100\n","60\n","100\n","61\n","100\n","62\n","100\n","63\n","100\n","64\n","100\n","65\n","100\n","66\n","100\n","67\n","100\n","68\n","100\n","69\n","100\n","70\n","100\n","71\n","100\n","72\n","100\n","73\n","100\n","74\n","100\n","75\n","100\n","76\n","100\n","77\n","100\n","78\n","100\n","79\n","100\n","80\n","100\n","81\n","100\n","82\n","100\n","83\n","100\n","84\n","100\n","85\n","100\n","86\n","100\n","87\n","100\n","88\n","100\n","89\n","100\n","90\n","100\n","91\n","100\n","92\n","100\n","93\n","100\n","94\n","100\n","95\n","100\n","96\n","100\n","97\n","100\n","98\n","100\n","99\n","100\n","100\n","100\n","101\n","100\n","102\n","100\n","103\n","100\n","104\n","100\n","105\n","100\n","106\n","100\n","107\n","100\n","108\n","100\n","109\n","100\n","110\n","100\n","111\n","100\n","112\n","100\n","113\n","100\n","114\n","100\n","115\n","100\n","116\n","100\n","117\n","100\n","118\n","100\n","119\n","100\n","120\n","100\n","121\n","100\n","122\n","100\n","123\n","100\n","124\n","100\n","125\n","100\n","126\n","100\n","127\n","100\n","128\n","100\n","129\n","100\n","130\n","100\n","131\n","100\n","132\n","100\n","133\n","100\n","134\n","100\n","135\n","100\n","136\n","100\n","137\n","100\n","138\n","100\n","139\n","100\n","140\n","100\n","141\n","100\n","142\n","100\n","143\n","100\n","144\n","100\n","145\n","100\n","146\n","100\n","147\n","100\n","148\n","100\n","149\n","100\n","150\n","100\n","151\n","100\n","152\n","100\n","153\n","100\n","154\n","100\n","155\n","100\n","156\n","100\n","157\n","100\n","158\n","100\n","159\n","100\n","160\n","100\n","161\n","100\n","162\n","100\n","163\n","100\n","164\n","100\n","165\n","100\n","166\n","100\n","167\n","100\n","168\n","100\n","169\n","100\n","170\n","100\n","171\n","100\n","172\n","100\n","173\n","100\n","174\n","100\n","175\n","100\n","176\n","100\n","177\n","100\n","178\n","100\n","179\n","100\n","180\n","100\n","181\n","100\n","182\n","100\n","183\n","100\n","184\n","100\n","185\n","100\n","torch.Size([15, 256, 1, 1])\n","torch.Size([15, 256, 1, 1])\n"]}],"source":["! python3 PIN_aug.py --dataset 'cityscapes' --data_root '/content/drive/MyDrive/PODA/datasets/data/Cityscapes'  --save_dir '/content/drive/MyDrive/성현/datasets/stastics_save(parameter Loss experiment)' --resize_feat --total_it 100"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"z22LqO5__Mtc"},"outputs":[],"source":[]},{"cell_type":"markdown","metadata":{"id":"TAwyPx9DjQkf"},"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":629269,"status":"ok","timestamp":1719851398527,"user":{"displayName":"yechan kim","userId":"05640365410708377891"},"user_tz":-540},"id":"SI2ldOwQcW1l","outputId":"158440db-2ade-4e60-dd4f-9c36b693bc0c"},"outputs":[{"name":"stdout","output_type":"stream","text":["2024-07-01 16:14:33.098085: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.\n","2024-07-01 16:14:33.149784: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n","2024-07-01 16:14:33.149831: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n","2024-07-01 16:14:33.151368: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n","2024-07-01 16:14:33.159142: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\n","To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n","2024-07-01 16:14:34.321677: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\n","Device: cuda\n","Dataset: cityscapes, Train set: 2975, Val set: 500\n","Model restored from /content/drive/MyDrive/PODA/CS_source.pth\n","/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.\n","  self.pid = os.fork()\n","/usr/local/lib/python3.10/dist-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at ../aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)\n","  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass\n","Epoch 1, Itrs 10/2000, Loss=0.448707\n","Epoch 1, Itrs 20/2000, Loss=0.468334\n","Epoch 1, Itrs 30/2000, Loss=0.406039\n","Epoch 1, Itrs 40/2000, Loss=0.450505\n","Epoch 1, Itrs 50/2000, Loss=0.320063\n","Epoch 1, Itrs 60/2000, Loss=0.440039\n","Epoch 1, Itrs 70/2000, Loss=0.296912\n","Epoch 1, Itrs 80/2000, Loss=0.340972\n","Epoch 1, Itrs 90/2000, Loss=0.354377\n","Epoch 1, Itrs 100/2000, Loss=0.348263\n","Epoch 1, Itrs 110/2000, Loss=0.330704\n","Epoch 1, Itrs 120/2000, Loss=0.389692\n","Epoch 1, Itrs 130/2000, Loss=0.318042\n","Epoch 1, Itrs 140/2000, Loss=0.334736\n","Epoch 1, Itrs 150/2000, Loss=0.313415\n","Epoch 1, Itrs 160/2000, Loss=0.332572\n","Epoch 1, Itrs 170/2000, Loss=0.338479\n","Epoch 1, Itrs 180/2000, Loss=0.401426\n","Epoch 1, Itrs 190/2000, Loss=0.283868\n","Epoch 1, Itrs 200/2000, Loss=0.297275\n","Epoch 1, Itrs 210/2000, Loss=0.311936\n","Epoch 1, Itrs 220/2000, Loss=0.320498\n","Epoch 1, Itrs 230/2000, Loss=0.313880\n","Epoch 1, Itrs 240/2000, Loss=0.329103\n","Epoch 1, Itrs 250/2000, Loss=0.337390\n","Epoch 1, Itrs 260/2000, Loss=0.367117\n","Epoch 1, Itrs 270/2000, Loss=0.284804\n","Epoch 1, Itrs 280/2000, Loss=0.320427\n","Epoch 1, Itrs 290/2000, Loss=0.313718\n","Epoch 1, Itrs 300/2000, Loss=0.309003\n","Epoch 1, Itrs 310/2000, Loss=0.298382\n","Epoch 1, Itrs 320/2000, Loss=0.325618\n","Epoch 1, Itrs 330/2000, Loss=0.285941\n","Epoch 1, Itrs 340/2000, Loss=0.306000\n","Epoch 1, Itrs 350/2000, Loss=0.325900\n","Epoch 1, Itrs 360/2000, Loss=0.334261\n","Epoch 1, Itrs 370/2000, Loss=0.277877\n","Epoch 2, Itrs 380/2000, Loss=0.288631\n","Epoch 2, Itrs 390/2000, Loss=0.279494\n","Epoch 2, Itrs 400/2000, Loss=0.306445\n","Epoch 2, Itrs 410/2000, Loss=0.261384\n","Epoch 2, Itrs 420/2000, Loss=0.276507\n","Epoch 2, Itrs 430/2000, Loss=0.318129\n","Epoch 2, Itrs 440/2000, Loss=0.361964\n","Epoch 2, Itrs 450/2000, Loss=0.287172\n","Epoch 2, Itrs 460/2000, Loss=0.309191\n","Epoch 2, Itrs 470/2000, Loss=0.302329\n","Epoch 2, Itrs 480/2000, Loss=0.338260\n","Epoch 2, Itrs 490/2000, Loss=0.270159\n","Epoch 2, Itrs 500/2000, Loss=0.257904\n","Epoch 2, Itrs 510/2000, Loss=0.275178\n","Epoch 2, Itrs 520/2000, Loss=0.281788\n","Epoch 2, Itrs 530/2000, Loss=0.362002\n","Epoch 2, Itrs 540/2000, Loss=0.308063\n","Epoch 2, Itrs 550/2000, Loss=0.280725\n","Epoch 2, Itrs 560/2000, Loss=0.276595\n","Epoch 2, Itrs 570/2000, Loss=0.260903\n","Epoch 2, Itrs 580/2000, Loss=0.342532\n","Epoch 2, Itrs 590/2000, Loss=0.317329\n","Epoch 2, Itrs 600/2000, Loss=0.297140\n","Epoch 2, Itrs 610/2000, Loss=0.261806\n","Epoch 2, Itrs 620/2000, Loss=0.316855\n","Epoch 2, Itrs 630/2000, Loss=0.266099\n","Epoch 2, Itrs 640/2000, Loss=0.322872\n","Epoch 2, Itrs 650/2000, Loss=0.293474\n","Epoch 2, Itrs 660/2000, Loss=0.285453\n","Epoch 2, Itrs 670/2000, Loss=0.344722\n","Epoch 2, Itrs 680/2000, Loss=0.307980\n","Epoch 2, Itrs 690/2000, Loss=0.289642\n","Epoch 2, Itrs 700/2000, Loss=0.307815\n","Epoch 2, Itrs 710/2000, Loss=0.313855\n","Epoch 2, Itrs 720/2000, Loss=0.279595\n","Epoch 2, Itrs 730/2000, Loss=0.273365\n","Epoch 2, Itrs 740/2000, Loss=0.250758\n","Epoch 3, Itrs 750/2000, Loss=0.256794\n","Epoch 3, Itrs 760/2000, Loss=0.282301\n","Epoch 3, Itrs 770/2000, Loss=0.300904\n","Epoch 3, Itrs 780/2000, Loss=0.248639\n","Epoch 3, Itrs 790/2000, Loss=0.289656\n","Epoch 3, Itrs 800/2000, Loss=0.269532\n","Epoch 3, Itrs 810/2000, Loss=0.297840\n","Epoch 3, Itrs 820/2000, Loss=0.252627\n","Epoch 3, Itrs 830/2000, Loss=0.305974\n","Epoch 3, Itrs 840/2000, Loss=0.288588\n","Epoch 3, Itrs 850/2000, Loss=0.258801\n","Epoch 3, Itrs 860/2000, Loss=0.270418\n","Epoch 3, Itrs 870/2000, Loss=0.319177\n","Epoch 3, Itrs 880/2000, Loss=0.290516\n","Epoch 3, Itrs 890/2000, Loss=0.307933\n","Epoch 3, Itrs 900/2000, Loss=0.261620\n","Epoch 3, Itrs 910/2000, Loss=0.278487\n","Epoch 3, Itrs 920/2000, Loss=0.253381\n","Epoch 3, Itrs 930/2000, Loss=0.262445\n","Epoch 3, Itrs 940/2000, Loss=0.248476\n","Epoch 3, Itrs 950/2000, Loss=0.295676\n","Epoch 3, Itrs 960/2000, Loss=0.278584\n","Epoch 3, Itrs 970/2000, Loss=0.276425\n","Epoch 3, Itrs 980/2000, Loss=0.288462\n","Epoch 3, Itrs 990/2000, Loss=0.341364\n","Epoch 3, Itrs 1000/2000, Loss=0.240711\n","Epoch 3, Itrs 1010/2000, Loss=0.288104\n","Epoch 3, Itrs 1020/2000, Loss=0.321105\n","Epoch 3, Itrs 1030/2000, Loss=0.278220\n","Epoch 3, Itrs 1040/2000, Loss=0.326722\n","Epoch 3, Itrs 1050/2000, Loss=0.210464\n","Epoch 3, Itrs 1060/2000, Loss=0.257226\n","Epoch 3, Itrs 1070/2000, Loss=0.262844\n","Epoch 3, Itrs 1080/2000, Loss=0.236380\n","Epoch 3, Itrs 1090/2000, Loss=0.321689\n","Epoch 3, Itrs 1100/2000, Loss=0.297813\n","Epoch 3, Itrs 1110/2000, Loss=0.261231\n","Epoch 4, Itrs 1120/2000, Loss=0.277269\n","Epoch 4, Itrs 1130/2000, Loss=0.277826\n","Epoch 4, Itrs 1140/2000, Loss=0.257407\n","Epoch 4, Itrs 1150/2000, Loss=0.239316\n","Epoch 4, Itrs 1160/2000, Loss=0.293033\n","Epoch 4, Itrs 1170/2000, Loss=0.266899\n","Epoch 4, Itrs 1180/2000, Loss=0.243662\n","Epoch 4, Itrs 1190/2000, Loss=0.289096\n","Epoch 4, Itrs 1200/2000, Loss=0.270921\n","Epoch 4, Itrs 1210/2000, Loss=0.278297\n","Epoch 4, Itrs 1220/2000, Loss=0.286013\n","Epoch 4, Itrs 1230/2000, Loss=0.261627\n","Epoch 4, Itrs 1240/2000, Loss=0.282014\n","Epoch 4, Itrs 1250/2000, Loss=0.259301\n","Epoch 4, Itrs 1260/2000, Loss=0.277048\n","Epoch 4, Itrs 1270/2000, Loss=0.272025\n","Epoch 4, Itrs 1280/2000, Loss=0.260200\n","Epoch 4, Itrs 1290/2000, Loss=0.283906\n","Epoch 4, Itrs 1300/2000, Loss=0.247572\n","Epoch 4, Itrs 1310/2000, Loss=0.320706\n","Epoch 4, Itrs 1320/2000, Loss=0.297861\n","Epoch 4, Itrs 1330/2000, Loss=0.231358\n","Epoch 4, Itrs 1340/2000, Loss=0.283995\n","Epoch 4, Itrs 1350/2000, Loss=0.257099\n","Epoch 4, Itrs 1360/2000, Loss=0.254108\n","Epoch 4, Itrs 1370/2000, Loss=0.286350\n","Epoch 4, Itrs 1380/2000, Loss=0.328486\n","Epoch 4, Itrs 1390/2000, Loss=0.265170\n","Epoch 4, Itrs 1400/2000, Loss=0.260284\n","Epoch 4, Itrs 1410/2000, Loss=0.280773\n","Epoch 4, Itrs 1420/2000, Loss=0.257705\n","Epoch 4, Itrs 1430/2000, Loss=0.273213\n","Epoch 4, Itrs 1440/2000, Loss=0.310556\n","Epoch 4, Itrs 1450/2000, Loss=0.274013\n","Epoch 4, Itrs 1460/2000, Loss=0.217845\n","Epoch 4, Itrs 1470/2000, Loss=0.249786\n","Epoch 4, Itrs 1480/2000, Loss=0.255151\n","Epoch 5, Itrs 1490/2000, Loss=0.241457\n","Epoch 5, Itrs 1500/2000, Loss=0.254794\n","Epoch 5, Itrs 1510/2000, Loss=0.248010\n","Epoch 5, Itrs 1520/2000, Loss=0.255603\n","Epoch 5, Itrs 1530/2000, Loss=0.247844\n","Epoch 5, Itrs 1540/2000, Loss=0.274991\n","Epoch 5, Itrs 1550/2000, Loss=0.282250\n","Epoch 5, Itrs 1560/2000, Loss=0.256870\n","Epoch 5, Itrs 1570/2000, Loss=0.270428\n","Epoch 5, Itrs 1580/2000, Loss=0.267419\n","Epoch 5, Itrs 1590/2000, Loss=0.317640\n","Epoch 5, Itrs 1600/2000, Loss=0.245960\n","Epoch 5, Itrs 1610/2000, Loss=0.263411\n","Epoch 5, Itrs 1620/2000, Loss=0.282822\n","Epoch 5, Itrs 1630/2000, Loss=0.240197\n","Epoch 5, Itrs 1640/2000, Loss=0.239289\n","Epoch 5, Itrs 1650/2000, Loss=0.247713\n","Epoch 5, Itrs 1660/2000, Loss=0.256060\n","Epoch 5, Itrs 1670/2000, Loss=0.250149\n","Epoch 5, Itrs 1680/2000, Loss=0.290633\n","Epoch 5, Itrs 1690/2000, Loss=0.239478\n","Epoch 5, Itrs 1700/2000, Loss=0.310348\n","Epoch 5, Itrs 1710/2000, Loss=0.333063\n","Epoch 5, Itrs 1720/2000, Loss=0.275148\n","Epoch 5, Itrs 1730/2000, Loss=0.306421\n","Epoch 5, Itrs 1740/2000, Loss=0.317245\n","Epoch 5, Itrs 1750/2000, Loss=0.265011\n","Epoch 5, Itrs 1760/2000, Loss=0.262150\n","Epoch 5, Itrs 1770/2000, Loss=0.234059\n","Epoch 5, Itrs 1780/2000, Loss=0.248457\n","Epoch 5, Itrs 1790/2000, Loss=0.265807\n","Epoch 5, Itrs 1800/2000, Loss=0.254667\n","Epoch 5, Itrs 1810/2000, Loss=0.264974\n","Epoch 5, Itrs 1820/2000, Loss=0.247779\n","Epoch 5, Itrs 1830/2000, Loss=0.252199\n","Epoch 5, Itrs 1840/2000, Loss=0.272893\n","Epoch 5, Itrs 1850/2000, Loss=0.261866\n","Epoch 6, Itrs 1860/2000, Loss=0.254340\n","Epoch 6, Itrs 1870/2000, Loss=0.271881\n","Epoch 6, Itrs 1880/2000, Loss=0.298092\n","Epoch 6, Itrs 1890/2000, Loss=0.240466\n","Epoch 6, Itrs 1900/2000, Loss=0.252509\n","Epoch 6, Itrs 1910/2000, Loss=0.251114\n","Epoch 6, Itrs 1920/2000, Loss=0.244605\n","Epoch 6, Itrs 1930/2000, Loss=0.236365\n","Epoch 6, Itrs 1940/2000, Loss=0.296923\n","Epoch 6, Itrs 1950/2000, Loss=0.277021\n","Epoch 6, Itrs 1960/2000, Loss=0.283417\n","Epoch 6, Itrs 1970/2000, Loss=0.257794\n","Epoch 6, Itrs 1980/2000, Loss=0.279398\n","Epoch 6, Itrs 1990/2000, Loss=0.269187\n","Epoch 6, Itrs 2000/2000, Loss=0.249232\n","Model saved as adapted/adapted_deeplabv3plus_resnet_clip_cityscapes.pth\n"]}],"source":["! python3 main.py --dataset 'cityscapes' --data_root '/content/drive/MyDrive/PODA/datasets/data/Cityscapes' --ckpt '/content/drive/MyDrive/PODA/CS_source.pth' --batch_size 8 --lr 0.01 --ckpts_path adapted --freeze_BB --train_aug --total_itrs 2000  --path_mu_sig '/content/drive/MyDrive/성현/datasets/stastics_save(parameter Loss experiment)'"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":28195,"status":"ok","timestamp":1719852409945,"user":{"displayName":"yechan kim","userId":"05640365410708377891"},"user_tz":-540},"id":"1YO34_AYdnFU","outputId":"dc1454fe-f2ee-4a4d-d5be-d4c1a4a27b20"},"outputs":[{"name":"stdout","output_type":"stream","text":["2024-07-01 16:46:25.573371: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.\n","2024-07-01 16:46:25.625142: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n","2024-07-01 16:46:25.625194: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n","2024-07-01 16:46:25.626524: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n","2024-07-01 16:46:25.634013: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\n","To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n","2024-07-01 16:46:26.831490: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\n","Device: cuda\n","/content/drive/MyDrive/PODA/datasets/data/ACDC/rgb_anon/rain/train\n","/content/drive/MyDrive/PODA/datasets/data/ACDC/rgb_anon/rain/val\n","Dataset: ACDC, Train set: 400, Val set: 100\n","Model restored from /content/drive/MyDrive/성현/PODA/adapted/adapted_deeplabv3plus_resnet_clip_cityscapes.pth\n","/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.\n","  self.pid = os.fork()\n","100% 100/100 [00:16<00:00,  6.00it/s]\n","\n","Overall Acc: 0.879981\n","Mean Acc: 0.614511\n","FreqW Acc: 0.809757\n","Mean IoU: 0.434823\n","\n","0.434823473282244\n","{0: 0.7699357356200921, 1: 0.3966362366238295, 2: 0.7749931286923387, 3: 0.18428556561556875, 4: 0.22351758991624154, 5: 0.4033263298265137, 6: 0.5210193848027576, 7: 0.47934295544074873, 8: 0.8714675217797849, 9: 0.3316226918902654, 10: 0.9671105413403887, 11: 0.5361878740321254, 12: 0.09078620374125256, 13: 0.765308760166113, 14: 0.22124539431769072, 15: 0.07028617245694888, 16: 0.22890092256074243, 17: 0.21031401804302569, 18: 0.21535896549620803}\n"]}],"source":["! python3 main.py --dataset 'ACDC' --data_root '/content/drive/MyDrive/PODA/datasets/data/ACDC' --ckpt '/content/drive/MyDrive/성현/PODA/adapted/adapted_deeplabv3plus_resnet_clip_cityscapes.pth' --test_only --val_batch_size 1 --ACDC_sub 'rain'"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":75779,"status":"ok","timestamp":1720609612535,"user":{"displayName":"yechan kim","userId":"05640365410708377891"},"user_tz":-540},"id":"Rj6C5sEVhgrc","outputId":"cc14bc8f-f837-4743-88c5-948a42e0dad2"},"outputs":[{"output_type":"stream","name":"stdout","text":["2024-07-10 11:05:54.424823: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.\n","2024-07-10 11:05:54.474963: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n","2024-07-10 11:05:54.475016: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n","2024-07-10 11:05:54.476633: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n","2024-07-10 11:05:54.484133: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\n","To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n","2024-07-10 11:05:55.599012: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\n","Device: cuda\n","/content/drive/MyDrive/PODA/datasets/data/ACDC/rgb_anon/snow/train\n","/content/drive/MyDrive/PODA/datasets/data/ACDC/rgb_anon/snow/val\n","Dataset: ACDC, Train set: 400, Val set: 100\n","100%|███████████████████████████████████████| 244M/244M [00:03<00:00, 69.1MiB/s]\n","Model restored from /content/drive/MyDrive/성현/PODA/adapted/adapted_deeplabv3plus_resnet_clip_cityscapes.pth\n","/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.\n","  self.pid = os.fork()\n","100% 100/100 [00:35<00:00,  2.82it/s]\n","\n","Overall Acc: 0.858411\n","Mean Acc: 0.576776\n","FreqW Acc: 0.770709\n","Mean IoU: 0.447730\n","\n","0.4477303881286029\n","{0: 0.7648787962148272, 1: 0.3820527899840459, 2: 0.752004811458704, 3: 0.277407824468816, 4: 0.2774923041690388, 5: 0.37810244077819666, 6: 0.5712415338520029, 7: 0.48087859495708946, 8: 0.8270445030309299, 9: 0.10689171470917302, 10: 0.938557577930372, 11: 0.5529158695433284, 12: 0.010863761925764293, 13: 0.6964186883618132, 14: 0.26157171102036986, 15: 0.02453024318362151, 16: 0.45741327584557107, 17: 0.44725956081683194, 18: 0.299351372192959}\n"]}],"source":["! python3 main.py --dataset 'ACDC' --data_root '/content/drive/MyDrive/PODA/datasets/data/ACDC' --ckpt '/content/drive/MyDrive/성현/PODA/adapted/adapted_deeplabv3plus_resnet_clip_cityscapes.pth' --test_only --val_batch_size 1 --ACDC_sub 'snow'"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":79981,"status":"ok","timestamp":1719852610214,"user":{"displayName":"yechan kim","userId":"05640365410708377891"},"user_tz":-540},"id":"iNYz_uxBMlLu","outputId":"5f39d713-58eb-4445-fc35-500be47033d0"},"outputs":[{"name":"stdout","output_type":"stream","text":["2024-07-01 16:48:53.866965: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.\n","2024-07-01 16:48:53.917366: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n","2024-07-01 16:48:53.917416: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n","2024-07-01 16:48:53.918750: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n","2024-07-01 16:48:53.926098: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\n","To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n","2024-07-01 16:48:55.116301: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\n","Device: cuda\n","/content/drive/MyDrive/PODA/datasets/data/ACDC/rgb_anon/night/train\n","/content/drive/MyDrive/PODA/datasets/data/ACDC/rgb_anon/night/val\n","Dataset: ACDC, Train set: 400, Val set: 106\n","Model restored from /content/drive/MyDrive/성현/PODA/adapted/adapted_deeplabv3plus_resnet_clip_cityscapes.pth\n","/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.\n","  self.pid = os.fork()\n","100% 106/106 [01:04<00:00,  1.65it/s]\n","/content/drive/MyDrive/성현/PODA/metrics/stream_metrics.py:66: RuntimeWarning: invalid value encountered in divide\n","  acc_cls = np.diag(hist) / hist.sum(axis=1)\n","\n","Overall Acc: 0.555790\n","Mean Acc: 0.381323\n","FreqW Acc: 0.399227\n","Mean IoU: 0.230384\n","\n","0.23038390893693775\n","{0: 0.7498740672313942, 1: 0.24544761200116272, 2: 0.3622264634471727, 3: 0.10225559308781867, 4: 0.17851013660820497, 5: 0.31116142590028845, 6: 0.26934464296232913, 7: 0.21631186150005682, 8: 0.3707495902197541, 9: 0.05752683467042601, 10: 0.13948442346281145, 11: 0.28523717570697904, 12: 0.1424399948658709, 13: 0.4695336679390713, 14: 0.09103375214106792, 15: 0.0, 16: 0.1743062419085607, 17: 0.0865132186353455, 18: 0.1253375675135027}\n"]}],"source":["! python3 main.py --dataset 'ACDC' --data_root '/content/drive/MyDrive/PODA/datasets/data/ACDC' --ckpt '/content/drive/MyDrive/성현/PODA/adapted/adapted_deeplabv3plus_resnet_clip_cityscapes.pth' --test_only --val_batch_size 1 --ACDC_sub 'night'"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vZggCNJ_Mopp"},"outputs":[],"source":[]}],"metadata":{"accelerator":"GPU","colab":{"gpuType":"T4","machine_shape":"hm","provenance":[{"file_id":"1JTjp1xDnEGlqcjv2YfOk8t98aUUxV_4j","timestamp":1720612110277}],"authorship_tag":"ABX9TyO8WdE1HklZS1xNR9Yn0ZZT"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}